CREATE TABLE snapshots (
  snapshot_id TEXT PRIMARY KEY,
  created_at TEXT NOT NULL,
  source TEXT NOT NULL,
  scryfall_bulk_uri TEXT NOT NULL,
  scryfall_bulk_updated_at TEXT,
  manifest_json TEXT NOT NULL
);

CREATE TABLE cards (
  snapshot_id TEXT NOT NULL,
  oracle_id TEXT NOT NULL,
  name TEXT NOT NULL,
  mana_cost TEXT,
  cmc REAL,
  type_line TEXT,
  oracle_text TEXT,
  colors TEXT,
  color_identity TEXT,
  produced_mana TEXT,
  keywords TEXT,
  legalities_json TEXT,
  primitives_json TEXT,
  PRIMARY KEY (snapshot_id, oracle_id)
);

INSERT INTO snapshots (
  snapshot_id,
  created_at,
  source,
  scryfall_bulk_uri,
  scryfall_bulk_updated_at,
  manifest_json
) VALUES (
  'GUARDRAILS_TEST_SNAPSHOT',
  '2026-02-21T00:00:00+00:00',
  'guardrails_fixture',
  'local://guardrails/fixture',
  '2026-02-21T00:00:00+00:00',
  '{"tags_compiled":1}'
);

INSERT INTO cards (
  snapshot_id,
  oracle_id,
  name,
  mana_cost,
  cmc,
  type_line,
  oracle_text,
  colors,
  color_identity,
  produced_mana,
  keywords,
  legalities_json,
  primitives_json
) VALUES
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CMDR_001',
  'Niv-Mizzet, Parun',
  '{U}{U}{U}{R}{R}{R}',
  6,
  'Legendary Creature — Dragon Wizard',
  NULL,
  '["U","R"]',
  '["U","R"]',
  '["U","R"]',
  '[]',
  '{"commander":"legal"}',
  '["COMMANDER_ENGINE"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CMDR_002',
  'Esior, Wardwing Familiar',
  '{1}{U}',
  2,
  'Legendary Creature — Bird',
  NULL,
  '["U"]',
  '["U"]',
  '["U"]',
  '[]',
  '{"commander":"legal"}',
  '["COMMANDER_ENGINE"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CMDR_003',
  'Ishai, Ojutai Dragonspeaker',
  '{2}{W}{U}',
  4,
  'Legendary Creature — Bird Monk',
  NULL,
  '["W","U"]',
  '["W","U"]',
  '["W","U"]',
  '[]',
  '{"commander":"legal"}',
  '["COMMANDER_ENGINE"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_010',
  'Hybrid Engine Piece',
  '{U}{R}',
  2,
  'Artifact',
  NULL,
  '["U","R"]',
  '["U","R"]',
  '[]',
  '[]',
  '{"commander":"legal"}',
  '["RAMP_MANA","CARD_DRAW"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_015',
  'Conjured Practice Token',
  '',
  0,
  'Token Artifact — Clue',
  NULL,
  '[]',
  '[]',
  '[]',
  '[]',
  '{"commander":"not_legal"}',
  '["RAMP_MANA"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_020',
  'Arcane Signet',
  '{2}',
  2,
  'Artifact',
  NULL,
  '[]',
  '[]',
  '["U","R"]',
  '[]',
  '{"commander":"legal"}',
  '["RAMP_MANA"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_030',
  'Opt',
  '{U}',
  1,
  'Instant',
  NULL,
  '["U"]',
  '["U"]',
  '[]',
  '[]',
  '{"commander":"legal"}',
  '["CARD_DRAW"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_040',
  'Rhystic Study',
  '{2}{U}',
  3,
  'Enchantment',
  NULL,
  '["U"]',
  '["U"]',
  '[]',
  '[]',
  '{"commander":"legal"}',
  '["CARD_DRAW"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_050',
  'Cultivate',
  '{2}{G}',
  3,
  'Sorcery',
  NULL,
  '["G"]',
  '["G"]',
  '[]',
  '[]',
  '{"commander":"legal"}',
  '["RAMP_MANA"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_060',
  'Mystery Card',
  '{2}',
  2,
  'Artifact',
  NULL,
  '[]',
  NULL,
  '[]',
  '[]',
  '{"commander":"legal"}',
  '["RAMP_MANA"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_070',
  'Plain Utility',
  '{1}',
  1,
  'Artifact',
  NULL,
  '[]',
  '[]',
  '[]',
  '[]',
  '{"commander":"legal"}',
  '[]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_080',
  'Cyclonic Rift',
  '{1}{U}',
  2,
  'Instant',
  NULL,
  '["U"]',
  '["U"]',
  '[]',
  '[]',
  '{"commander":"legal"}',
  '["INTERACTION"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_090',
  'Force of Will',
  '{3}{U}{U}',
  5,
  'Instant',
  NULL,
  '["U"]',
  '["U"]',
  '[]',
  '[]',
  '{"commander":"legal"}',
  '["INTERACTION"]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_100',
  'Island',
  '',
  0,
  'Basic Land — Island',
  NULL,
  '[]',
  '["U"]',
  '["U"]',
  '[]',
  '{"commander":"legal"}',
  '[]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_110',
  'Mountain',
  '',
  0,
  'Basic Land — Mountain',
  NULL,
  '[]',
  '["R"]',
  '["R"]',
  '[]',
  '{"commander":"legal"}',
  '[]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_115',
  'Plains',
  '',
  0,
  'Basic Land — Plains',
  NULL,
  '[]',
  '["W"]',
  '["W"]',
  '[]',
  '{"commander":"legal"}',
  '[]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_120',
  'Snow-Covered Island',
  '',
  0,
  'Basic Snow Land — Island',
  NULL,
  '[]',
  '["U"]',
  '["U"]',
  '[]',
  '{"commander":"legal"}',
  '[]'
),
(
  'GUARDRAILS_TEST_SNAPSHOT',
  'ORA_CAN_130',
  'Snow-Covered Mountain',
  '',
  0,
  'Basic Snow Land — Mountain',
  NULL,
  '[]',
  '["R"]',
  '["R"]',
  '[]',
  '{"commander":"legal"}',
  '[]'
);
